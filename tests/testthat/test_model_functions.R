data.frame(
  y = c(10, 11, 11, 13, 10, 11, 10, 11, 4, 2, 7, 10, 9, 9, 6, 5, 5, 5, 6, 4, 3,
         3, 4, 10, 6, 8, 2, 0),
  x1 = c(2113, 2003, 2957, 2285, 2971, 2309, 2528, 2147, 1689, 2566, 2363, 2109,
         2295, 1932, 2213, 1722, 1498, 1873, 2118, 1775, 1904, 1929, 2080, 2301,
         2040, 2447, 1416, 1503),
  x2 = c(1985, 2855, 1737, 2905, 1666, 2927, 2341, 2737, 1414, 1838, 1480, 2191,
         2229, 2204, 2140, 1730, 2072, 2929, 2268, 1983, 1792, 1606, 1492, 2835,
         2416, 1638, 2649, 1503),
  x3 = c(38.9, 38.8, 40.1, 41.6, 39.2, 39.7, 38.1, 37, 42.1, 42.3, 37.3, 39.5,
         37.4, 35.1, 38.8, 36.6, 35.3, 41.1, 38.2, 39.3, 39.7, 39.7, 35.5, 35.3,
         38.7, 39.9, 37.4, 39.3),
  x4 = c(64.7, 61.3, 60, 45.3, 53.8, 74.1, 65.4, 78.3, 47.6, 54.2, 48, 51.9,
         53.6, 71.4, 58.3, 52.6, 59.3, 55.3, 69.6, 78.3, 38.1, 68.8, 68.8, 74.1,
         50, 57.1, 56.3, 47),
  x5 = c(4, 3, 14, -4, 15, 8, 12, -1, -3, -1, 19, 6, -5, 3, 6, -19, -5, 10, 6,
         7, -9, -21, -8, 2, 0, -8, -22, -9),
  x6 = c(868, 615, 914, 957, 836, 786, 754, 761, 714, 797, 984, 700, 1037, 986,
         819, 791, 776, 789, 582, 901, 734, 627, 722, 683, 576, 848, 684, 875),
  x7 = c(59.7, 55, 65.6, 61.4, 66.1, 61, 66.1, 58, 57, 58.9, 67.5, 57.2, 58.8,
         58.6, 59.2, 54.4, 49.6, 54.3, 58.7, 51.7, 61.9, 52.7, 57.8, 59.7, 54.9,
         65.3, 43.8, 53.5),
  x8 = c(2205, 2096, 1847, 1903, 1457, 1848, 1564, 1821, 2577, 2476, 1984, 1917,
         1761, 1709, 1901, 2288, 2072, 2861, 2411, 2289, 2203, 2592, 2053, 1979,
         2048, 1786, 2876, 2560),
  x9 = c(1917, 1575, 2175, 2476, 1866, 2339, 2092, 1909, 2001, 2254, 2217, 1758,
         2032, 2025, 1686, 1835, 1914, 2496, 2670, 2202, 1988, 2324, 2550, 2110,
         2628, 1776, 2524, 2241),
  stringsAsFactors = FALSE) -> data_table_B1

# Libraries
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(dplyr))

lm(y ~ x2 + x7 + x8, data_table_B1) -> fit

test_that("standard error - for unsupplied match fit", {
  se(fit) %>%
    expect_equal(fit$residuals %>% `^`(2) %>% unname)
})

test_that("standard error - for full table match fit", {
  se(fit, data_table_B1) %>%
    expect_equal(fit$residuals %>% `^`(2) %>% unname)
})
